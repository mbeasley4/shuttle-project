<!-- sections/testimonial.liquid -->
{% comment %}
  Grid of testimonials.

  Globals:
    - settings.layout_horizontal: horizontally margin
    - settings.enable_animations: boolean to enable animations
    - settings.thumbnails_color_border: border color
    - settings.thumbnails_color_scheme: color scheme of thumbnails

  Possible enhancements:
    - Add alternative layout with large quote.
{% endcomment %}
<div id="testimonials-slider" class="py-16 bg-gray-50">
  <div class="mx-auto px-6 relative">
    {% if section.settings.heading != blank %}
      <h2 class="text-4xl font-bold text-center mb-12 text-gray-900">
        {{ section.settings.heading }}
      </h2>
    {% endif %}

    <!-- Center the whole slider -->
    <div class="swiper testimonial-swiper relative">
      <div class="swiper-wrapper mx-auto max-w-4xl" id="testimonial-slides"></div>
      <div class="ss-controls max-w-4xl">
        <!-- Add the pagination dots -->
        <div class="swiper-pagination"></div>
        <!-- Add the navigation arrows -->
        <div class="swiper-button-prev"></div>
        <div class="swiper-button-next"></div>
      </div>
    </div>
  </div>
</div>
{% stylesheet %}
  #testimonials-slider {
    overflow-x: hidden;
  }

  .testimonial-swiper .swiper-button-prev {
    left: -0.5rem !important;
  }
  .testimonial-swiper .swiper-button-next {
    right: -1rem !important;
  }
  #testimonials-slider .ss-controls {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 1;
    width: 100%;
    height: 100%;
  }
{% endstylesheet %}
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const ASSET_BASE_URL = "{{ 'theme.css' | asset_url | split: 'assets/theme.css' | first }}";

    fetch('{{ "testimonials.json" | asset_url }}')
      .then((res) => res.json())
      .then((items) => {
        const wrapper = document.getElementById('testimonial-slides');

        wrapper.innerHTML = items
          .map(
            (t) => `
        <div class="swiper-slide flex justify-center">
          <div class="p-10 max-w-4xl flex justify-center flex-col items-center">

            <img 
              src="${ASSET_BASE_URL}${t.image}"
              alt="${t.author}"
              class="w-18 h-18 rounded-full mb-12 border-2 p-2 border-gray-200 shadow"
            />

            <p class="text-3xl italic text-gray-700 py-6 text-center">
              "${t.quote}"
            </p>

            <div class="font-semibold text-gray-900">${t.author}</div>
            ${t.company ? `<div class="text-sm text-gray-500">${t.company}</div>` : ''}
          </div>
        </div>
      `
          )
          .join('');

        new Swiper('.testimonial-swiper', {
          loop: true,
          centeredSlides: true,
          slidesPerView: 1,
          spaceBetween: 4,
          autoplay: {
            delay: 5000,
            disableOnInteraction: false,
          },

          pagination: {
            el: '.swiper-pagination',
            clickable: true,
          },
          navigation: {
            nextEl: '.swiper-button-next',
            prevEl: '.swiper-button-prev',
          },
        });
      })
      .catch((err) => console.error('Testimonials JSON error:', err));
  });
</script>

{% schema %}
{
  "name": "Testimonials Slider",
  "tag": "section",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "What Our Customers Say"
    }
  ],
  "presets": [{ "name": "Testimonials Slider" }]
}
{% endschema %}
